{
  "metadata": {
    "generated_at": "2026-01-17",
    "updated_at": "2026-01-17 15:35:00",
    "auditor": "Claude Opus 4.5",
    "version": "2.0",
    "total_items": 67,
    "errors": 19,
    "improvements": 48
  },
  "errors": [
    {
      "id": "ERR-001",
      "severity": "CRITICAL",
      "file": "engine/tools/consolidar_cola.py",
      "line": "53-66",
      "type": "RACE_CONDITION",
      "title": "FileLock con potencial deadlock",
      "description": "El metodo acquire() usa loop infinito sin proteccion contra deadlocks. Si dos procesos intentan adquirir el lock simultaneamente en Windows, puede haber bloqueo indefinido.",
      "impact": "Datos pueden quedarse sin sincronizar o corromperse si bot_dreamer y juez ejecutan simultaneamente",
      "fix": "Implementar threading.Lock() o usar portalocker. Asegurar que fd se cierra en todos los paths de retorno.",
      "status": "PENDING"
    },
    {
      "id": "ERR-002",
      "severity": "CRITICAL",
      "file": "engine/models/bot_dreamer.py",
      "line": "382-384",
      "type": "SILENT_FAILURE",
      "title": "OraculoNeural usado sin validar metodos",
      "description": "Si OraculoNeural falla al cargar, se setea a None. Pero luego 'if OraculoNeural:' solo verifica que no es None, sin validar que tenga los metodos necesarios.",
      "impact": "El bot corre a media capacidad sin error visible. Las predicciones de IA se ignoran completamente.",
      "fix": "Validar que OraculoNeural tiene metodo predecir() antes de usarlo, o usar hasattr().",
      "status": "PENDING"
    },
    {
      "id": "ERR-003",
      "severity": "CRITICAL",
      "file": "engine/models/juez_implacable.py",
      "line": "164-171",
      "type": "SECURITY",
      "title": "ast.literal_eval() inseguro",
      "description": "Se usa ast.literal_eval() para parsear listas de numeros. Si el input contiene codigo malicioso o mal formateado, puede fallar.",
      "impact": "Riesgo de seguridad. Inyeccion de codigo posible si datos vienen de fuente externa.",
      "fix": "Reemplazar con json.loads() que es mas seguro para parsear estructuras de datos.",
      "status": "PENDING"
    },
    {
      "id": "ERR-004",
      "severity": "CRITICAL",
      "file": "engine/models/consolidar_laboratorio.py",
      "line": 41,
      "type": "DATA_CORRUPTION",
      "title": "NaN sanitization fragil",
      "description": "La condicion (v == v) para detectar NaN es fragil. Si hay valores infinitos o tipos complejos, la serializacion JSON falla.",
      "impact": "Dashboard puede corromperse con registros vacios o causar crash.",
      "fix": "Usar pd.isna() de pandas o math.isnan()/math.isinf() explicitamente.",
      "status": "PENDING"
    },
    {
      "id": "ERR-005",
      "severity": "HIGH",
      "file": "engine/models/bot_dreamer.py",
      "line": "367-375",
      "type": "LOGIC_ERROR",
      "title": "Loop de consenso puede terminar con menos de 5 muestras",
      "description": "El contador validas se incrementa dentro del if, pero reintentos siempre. Si hay muchos rechazos, se sale del loop antes de conseguir 5 validas.",
      "impact": "El consenso puede basarse en <5 muestras, reduciendo confiabilidad estadistica.",
      "fix": "Cambiar a 'while validas < 5 and reintentos < 100:' o aumentar limite de reintentos.",
      "status": "PENDING"
    },
    {
      "id": "ERR-006",
      "severity": "HIGH",
      "file": "engine/models/oraculo_neural.py",
      "line": "318-319",
      "type": "INDEX_ERROR",
      "title": "Acceso a indices negativos si X_raw es pequeno",
      "description": "Si len(X_raw) < self.window_size, el loop accede a indices negativos de forma inesperada.",
      "impact": "IndexError silencioso o predicciones incorrectas con datasets pequenos.",
      "fix": "Validar 'if len(X_raw) < self.window_size: return []' antes del loop.",
      "status": "PENDING"
    },
    {
      "id": "ERR-007",
      "severity": "HIGH",
      "file": "engine/scrapers/scraper_maestro.py",
      "line": 249,
      "type": "TIMEOUT_ERROR",
      "title": "Timeout de 3 segundos muy corto para Polla.cl",
      "description": "El asyncio.sleep(3) despues de goto() es insuficiente en conexiones lentas.",
      "impact": "Scraper falla frecuentemente en redes lentas.",
      "fix": "Aumentar a 10+ segundos o usar wait_until='networkidle'.",
      "status": "PENDING"
    },
    {
      "id": "ERR-008",
      "severity": "MEDIUM",
      "file": "engine/models/bot_dreamer.py",
      "line": "124, 131",
      "type": "EXCEPTION_HANDLING",
      "title": "Excepcion generica sin logging especifico",
      "description": "Se capturan TODAS las excepciones con 'except:' sin especificar tipo.",
      "impact": "Dificil debuggear problemas de parsing de fechas.",
      "fix": "Especificar 'except ValueError:' y loguear el error especifico.",
      "status": "PENDING"
    },
    {
      "id": "ERR-009",
      "severity": "MEDIUM",
      "file": "engine/models/loto3_tricore.py",
      "line": 111,
      "type": "VALIDATION_MISSING",
      "title": "Acceso a X.iloc[[-1]] sin validar que X tenga datos",
      "description": "No hay validacion de que X tenga al menos 1 fila antes de acceder al ultimo elemento.",
      "impact": "IndexError en prediccion de LOTO3 si datos estan vacios.",
      "fix": "Validar 'if len(X) == 0: return None' antes del acceso.",
      "status": "PENDING"
    },
    {
      "id": "ERR-010",
      "severity": "MEDIUM",
      "file": "varios",
      "line": "-",
      "type": "CONFIG_DUPLICATION",
      "title": "HORARIOS y GAME_CONFIG duplicados en 4+ archivos",
      "description": "Los mismos datos se definen en bot_dreamer.py, config.py, scraper_maestro.py, oraculo_neural.py.",
      "impact": "Bugs sutiles por falta de sincronizacion entre archivos.",
      "fix": "Centralizar TODO en config.py e importar desde ahi.",
      "status": "PENDING"
    },
    {
      "id": "ERR-011",
      "severity": "MEDIUM",
      "file": "engine/models/analizador_forense.py",
      "line": "176-192",
      "type": "PERFORMANCE",
      "title": "Loop de 5000 intentos en predict_smart_gaussian",
      "description": "Si los filtros son muy restrictivos, consume 5000 iteraciones innecesariamente.",
      "impact": "Rendimiento degradado, predicciones pueden tardar mucho.",
      "fix": "Reducir attempts < 5000 a attempts < 100 o 200.",
      "status": "PENDING"
    },
    {
      "id": "ERR-012",
      "severity": "MEDIUM",
      "file": "engine/models/entrenador_cognitivo.py",
      "line": 210,
      "type": "DATA_VALIDATION",
      "title": "groupby().unstack() puede fallar con datos vacios",
      "description": "Si no hay datos para cierta hora, la estructura puede ser inconsistente.",
      "impact": "Error ocasional en entrenamiento si hay datos vacios por hora.",
      "fix": "Anadir validacion 'if perf_horaria.empty: continue'.",
      "status": "PENDING"
    },
    {
      "id": "ERR-013",
      "severity": "LOW",
      "file": "loto_parser_v3.py, loto_parsers_mix.py",
      "line": "-",
      "type": "CODE_DUPLICATION",
      "title": "Logica de parseo duplicada entre archivos",
      "description": "Ambos archivos tienen manejo similar de errores pero codigo diferente.",
      "impact": "Posible divergencia de bugs entre parsers.",
      "fix": "Consolidar en un unico modulo parsers.py.",
      "status": "PENDING"
    },
    {
      "id": "ERR-014",
      "severity": "LOW",
      "file": "engine/models/juez_implacable.py",
      "line": "68-127",
      "type": "SCORING_INCONSISTENCY",
      "title": "Escala de afinidad no normalizada por n_balls",
      "description": "En entrenador_cognitivo.py se usa 'aciertos' directamente sin normalizar por maximo.",
      "impact": "Distorsion leve en ranking de algoritmos por juego.",
      "fix": "Normalizar pesos por maximo de aciertos del juego.",
      "status": "PENDING"
    },
    {
      "id": "ERR-015",
      "severity": "LOW",
      "file": "engine/scrapers/scraper_maestro.py",
      "line": "39-46, 341",
      "type": "NULL_CHECK_MISSING",
      "title": "Parser puede ser None pero se usa sin validar",
      "description": "Si parsers faltan, se setean a None, pero luego game['parser'] se asume callable.",
      "impact": "Scraper falla sin mensaje claro si parsers faltan.",
      "fix": "Validar 'if game[\"parser\"] is None: skip this game'.",
      "status": "PENDING"
    },
    {
      "id": "ERR-016",
      "severity": "LOW",
      "file": "engine/models/entrenador_cognitivo.py",
      "line": 257,
      "type": "SECURITY",
      "title": "ast.literal_eval() en lugar de json.loads()",
      "description": "Se usa ast.literal_eval() para parsear listas cuando json.loads() es mas seguro.",
      "impact": "Riesgo menor de seguridad en contexto local.",
      "fix": "Reemplazar con json.loads().",
      "status": "PENDING"
    },
    {
      "id": "ERR-017",
      "severity": "LOW",
      "file": "varios",
      "line": "-",
      "type": "INCONSISTENT_LOGGING",
      "title": "Mezcla de print() y logger sin coherencia",
      "description": "Algunos archivos usan print(), otros logger.xxx(). Inconsistente.",
      "impact": "Dificil debuggear, logs incompletos.",
      "fix": "Reemplazar todos los print() con logger.info() o similar.",
      "status": "PENDING"
    },
    {
      "id": "ERR-018",
      "severity": "LOW",
      "file": "engine/models/loto3_tricore.py",
      "line": "23-24",
      "type": "PATH_HANDLING",
      "title": "Rutas relativas debiles con os.path.dirname",
      "description": "Si el archivo se ejecuta desde un path diferente, PROJECT_ROOT puede calcularse mal.",
      "impact": "Fallos ocasionales si se ejecuta desde directorio distinto.",
      "fix": "Usar pathlib.Path o os.path.realpath().",
      "status": "PENDING"
    },
    {
      "id": "ERR-019",
      "severity": "LOW",
      "file": "engine/tools/consolidar_cola.py",
      "line": 41,
      "type": "CODE_CLARITY",
      "title": "Condicion v == v para detectar NaN es confusa",
      "description": "La condicion (v == v) aprovecha que NaN != NaN, pero es poco clara.",
      "impact": "Mantenibilidad reducida.",
      "fix": "Documentar o usar math.isnan() explicitamente.",
      "status": "PENDING"
    }
  ],
  "improvements": {
    "ml_algorithms": [
      {
        "id": "IMP-ML-001",
        "priority": "CRITICAL",
        "title": "Corregir overfitting en OraculoNeural",
        "description": "Train score 0.5+ vs Test score 0.15 indica que el modelo memoriza ruido en lugar de aprender patrones.",
        "file": "engine/models/oraculo_neural.py",
        "line": "275-283",
        "solution": "Aumentar regularizacion (max_depth=5, min_samples_leaf=20), reducir n_estimators, agregar dropout equivalente.",
        "impact": "Alto - Modelo actualmente inutil",
        "effort": "Medio"
      },
      {
        "id": "IMP-ML-002",
        "priority": "HIGH",
        "title": "Implementar XGBoost/LightGBM como alternativa a RandomForest",
        "description": "Gradient Boosting generalmente supera a RF en datos tabulares con mejor manejo de features.",
        "file": "engine/models/oraculo_neural.py",
        "solution": "Agregar XGBClassifier o LGBMClassifier como opcion, comparar metricas.",
        "impact": "Alto",
        "effort": "Medio"
      },
      {
        "id": "IMP-ML-003",
        "priority": "HIGH",
        "title": "Grid Search para hiperparametros",
        "description": "Hiperparametros actualmente hardcodeados (RF: 80 arboles, depth=8) sin optimizacion.",
        "file": "engine/config.py",
        "line": "115-117",
        "solution": "Implementar GridSearchCV o RandomizedSearchCV con TimeSeriesSplit.",
        "impact": "Alto",
        "effort": "Medio"
      },
      {
        "id": "IMP-ML-004",
        "priority": "HIGH",
        "title": "Implementar Stacking Ensemble",
        "description": "Combinar multiples modelos (RF, XGB, Markov, Frecuencias) con meta-learner.",
        "solution": "sklearn.ensemble.StackingClassifier con modelos base y LogisticRegression como meta.",
        "impact": "Alto",
        "effort": "Alto"
      },
      {
        "id": "IMP-ML-005",
        "priority": "MEDIUM",
        "title": "Early stopping en entrenamiento",
        "description": "Detener entrenamiento cuando validation loss deja de mejorar.",
        "solution": "Usar early_stopping en XGBoost o implementar manualmente con callbacks.",
        "impact": "Medio",
        "effort": "Bajo"
      },
      {
        "id": "IMP-ML-006",
        "priority": "MEDIUM",
        "title": "SMOTE para balanceo de clases",
        "description": "Clases desbalanceadas (algunos numeros aparecen mas que otros).",
        "solution": "from imblearn.over_sampling import SMOTE",
        "impact": "Medio",
        "effort": "Bajo"
      },
      {
        "id": "IMP-ML-007",
        "priority": "MEDIUM",
        "title": "Feature selection automatica",
        "description": "Eliminar features ruidosos que no aportan informacion.",
        "solution": "SelectKBest, RFE, o feature_importances_ de RF.",
        "impact": "Medio",
        "effort": "Medio"
      },
      {
        "id": "IMP-ML-008",
        "priority": "MEDIUM",
        "title": "Validacion cruzada temporal mejorada",
        "description": "Actualmente solo 80/20 split, sin K-fold temporal.",
        "file": "engine/models/oraculo_neural.py",
        "line": "242-245",
        "solution": "TimeSeriesSplit(n_splits=5, gap=10) para evitar data leakage.",
        "impact": "Medio",
        "effort": "Bajo"
      }
    ],
    "features": [
      {
        "id": "IMP-FEAT-001",
        "priority": "HIGH",
        "title": "Features de rachas (secuencias calientes/frias)",
        "description": "Detectar numeros que estan en racha positiva o negativa.",
        "solution": "Calcular: dias_desde_ultima_aparicion, frecuencia_ultimos_N_sorteos, tendencia.",
        "impact": "Alto",
        "effort": "Medio"
      },
      {
        "id": "IMP-FEAT-002",
        "priority": "MEDIUM",
        "title": "Embeddings de combinaciones",
        "description": "Representar combinaciones como vectores densos para capturar patrones ocultos.",
        "solution": "Word2Vec o autoencoders para combinaciones historicas.",
        "impact": "Alto",
        "effort": "Alto"
      },
      {
        "id": "IMP-FEAT-003",
        "priority": "MEDIUM",
        "title": "Analisis de correlacion entre posiciones",
        "description": "Detectar si ciertas posiciones tienen correlacion (ej: si n1=5, n2 tiende a ser par).",
        "solution": "Matriz de correlacion condicional, mutual information.",
        "impact": "Medio",
        "effort": "Medio"
      },
      {
        "id": "IMP-FEAT-004",
        "priority": "MEDIUM",
        "title": "Autoencoder para deteccion de anomalias",
        "description": "Filtrar predicciones que son estadisticamente anomalas.",
        "solution": "Entrenar autoencoder con combinaciones historicas, rechazar outliers.",
        "impact": "Medio",
        "effort": "Alto"
      },
      {
        "id": "IMP-FEAT-005",
        "priority": "LOW",
        "title": "Indice de sorpresa de sorteos anteriores",
        "description": "Medir cuan inesperado fue el sorteo anterior para ajustar prediccion.",
        "solution": "Calcular probabilidad del resultado vs modelo, usar como feature.",
        "impact": "Bajo",
        "effort": "Bajo"
      },
      {
        "id": "IMP-FEAT-006",
        "priority": "LOW",
        "title": "Distancia a combinaciones ganadoras previas",
        "description": "Evitar predecir combinaciones muy similares a las que ya ganaron.",
        "solution": "Distancia de Hamming o Jaccard a ultimos N ganadores.",
        "impact": "Bajo",
        "effort": "Bajo"
      }
    ],
    "auditing": [
      {
        "id": "IMP-AUD-001",
        "priority": "CRITICAL",
        "title": "Corregir scoring RACHA (0 aciertos = 100%?)",
        "description": "La curva en V invertida da 100% si aciertas 0 o 10. Logica incorrecta.",
        "file": "engine/models/juez_implacable.py",
        "line": "76-84",
        "solution": "Cambiar a curva monotona: mas aciertos = mejor score.",
        "impact": "Critico - Infla confianza artificialmente",
        "effort": "Bajo"
      },
      {
        "id": "IMP-AUD-002",
        "priority": "HIGH",
        "title": "Reset periodico de EMA (memoria infinita)",
        "description": "El exponential moving average nunca se resetea, un buen resultado de hace 2 anos sigue inflando peso.",
        "file": "engine/models/entrenador_cognitivo.py",
        "line": "50-52",
        "solution": "Implementar decay temporal o reset cada N sorteos.",
        "impact": "Alto",
        "effort": "Bajo"
      },
      {
        "id": "IMP-AUD-003",
        "priority": "MEDIUM",
        "title": "Agregar confianza bayesiana",
        "description": "Score actual es heuristico, no representa probabilidad real.",
        "solution": "Implementar calibracion de probabilidades con CalibratedClassifierCV.",
        "impact": "Medio",
        "effort": "Medio"
      },
      {
        "id": "IMP-AUD-004",
        "priority": "MEDIUM",
        "title": "Tracking de precision por hora/dia",
        "description": "Identificar si ciertos algoritmos funcionan mejor en franjas horarias especificas.",
        "file": "engine/models/entrenador_cognitivo.py",
        "solution": "Agregar metricas segmentadas por hora, dia_semana, mes.",
        "impact": "Medio",
        "effort": "Bajo"
      },
      {
        "id": "IMP-AUD-005",
        "priority": "MEDIUM",
        "title": "A/B testing de algoritmos",
        "description": "Comparar algoritmos de forma justa con mismas condiciones.",
        "solution": "Implementar framework de experimentos con grupos control/tratamiento.",
        "impact": "Alto",
        "effort": "Alto"
      },
      {
        "id": "IMP-AUD-006",
        "priority": "LOW",
        "title": "Metricas de calibracion (Brier score)",
        "description": "Evaluar si las probabilidades predichas son confiables.",
        "solution": "Calcular Brier score, reliability diagram, calibration curves.",
        "impact": "Medio",
        "effort": "Bajo"
      },
      {
        "id": "IMP-AUD-007",
        "priority": "MEDIUM",
        "title": "Validar rango de comodin LOTO (1-41)",
        "description": "Comodin se extrae pero no se valida que este en rango valido.",
        "file": "engine/models/juez_implacable.py",
        "line": "42-46",
        "solution": "Agregar validacion: if not 1 <= comodin <= 41: log warning.",
        "impact": "Bajo",
        "effort": "Bajo"
      }
    ],
    "data_quality": [
      {
        "id": "IMP-DATA-001",
        "priority": "MEDIUM",
        "title": "Normalizar headers CSV entre juegos",
        "description": "LOTO usa LOTO_n1, LOTO3 usa n1, LOTO4 mezcla n1 y pos1.",
        "files": "data/*.csv",
        "solution": "Estandarizar a formato consistente o crear capa de abstraccion.",
        "impact": "Medio",
        "effort": "Medio"
      },
      {
        "id": "IMP-DATA-002",
        "priority": "MEDIUM",
        "title": "Eliminar outliers automaticamente",
        "description": "detectar_anomalias() solo advierte, no remueve datos anomalos.",
        "file": "engine/models/entrenador_cognitivo.py",
        "line": "97-118",
        "solution": "Agregar opcion para remover automaticamente con z-score > 3.",
        "impact": "Medio",
        "effort": "Bajo"
      },
      {
        "id": "IMP-DATA-003",
        "priority": "LOW",
        "title": "Backup antes de modificar CSVs",
        "description": "Juez modifica SIMULACIONES.csv sin backup previo.",
        "file": "engine/models/juez_implacable.py",
        "solution": "Crear copia .bak antes de escribir cambios.",
        "impact": "Bajo",
        "effort": "Bajo"
      },
      {
        "id": "IMP-DATA-004",
        "priority": "LOW",
        "title": "Agregar checksum a CSVs",
        "description": "Detectar corrupcion de datos en CSVs.",
        "solution": "Calcular MD5/SHA256 y almacenar en metadata.",
        "impact": "Bajo",
        "effort": "Bajo"
      }
    ],
    "frontend": [
      {
        "id": "IMP-FE-001",
        "priority": "MEDIUM",
        "title": "Cache de CSV en localStorage",
        "description": "PapaParse carga CSV completo cada vez, toma 2-3 segundos.",
        "files": "js/index.js, js/laboratorio.js",
        "solution": "Cachear en localStorage con TTL de 5 minutos.",
        "impact": "Alto en UX",
        "effort": "Bajo"
      },
      {
        "id": "IMP-FE-002",
        "priority": "MEDIUM",
        "title": "Web Workers para carga pesada",
        "description": "Laboratorio carga multiples CSVs, UI se congela.",
        "file": "js/laboratorio.js",
        "solution": "Mover parsing a Web Worker.",
        "impact": "Alto en UX",
        "effort": "Medio"
      },
      {
        "id": "IMP-FE-003",
        "priority": "LOW",
        "title": "Modo oscuro toggle",
        "description": "Solo hay modo oscuro, algunos usuarios prefieren claro.",
        "files": "css/*.css",
        "solution": "Agregar toggle con CSS variables y localStorage.",
        "impact": "Bajo",
        "effort": "Bajo"
      },
      {
        "id": "IMP-FE-004",
        "priority": "LOW",
        "title": "Graficos de tendencia en tiempo real",
        "description": "Graficos actuales son estaticos.",
        "solution": "Implementar actualizacion periodica con setInterval o WebSocket.",
        "impact": "Medio",
        "effort": "Medio"
      },
      {
        "id": "IMP-FE-005",
        "priority": "LOW",
        "title": "PWA (Progressive Web App)",
        "description": "Permitir instalar como app en movil/desktop.",
        "solution": "Agregar manifest.json y service worker.",
        "impact": "Medio",
        "effort": "Medio"
      },
      {
        "id": "IMP-FE-006",
        "priority": "LOW",
        "title": "Exportar predicciones a PDF",
        "description": "Usuarios quieren guardar predicciones.",
        "solution": "Usar jsPDF o html2canvas.",
        "impact": "Bajo",
        "effort": "Bajo"
      }
    ],
    "infrastructure": [
      {
        "id": "IMP-INFRA-001",
        "priority": "CRITICAL",
        "title": "Sincronizar requirements.txt con CI",
        "description": "CI instala pandas, numpy, scikit-learn pero falta joblib (requerido por meta_learner).",
        "files": ".github/workflows/*.yml, requirements.txt",
        "solution": "Usar 'pip install -r requirements.txt' en CI en lugar de instalar manualmente.",
        "impact": "Critico - Modelos fallan en CI",
        "effort": "Bajo"
      },
      {
        "id": "IMP-INFRA-002",
        "priority": "HIGH",
        "title": "Resolver race conditions Sonador/Juez",
        "description": "Ambos workflows pueden correr en paralelo y modificar mismos archivos.",
        "files": ".github/workflows/sonador.yml, juez.yml",
        "solution": "Usar concurrency groups o workflow_dispatch con dependencias.",
        "impact": "Alto",
        "effort": "Medio"
      },
      {
        "id": "IMP-INFRA-003",
        "priority": "MEDIUM",
        "title": "Rotacion de logs automatica",
        "description": "Logs se acumulan sin limite, disco lleno en ~6 meses.",
        "file": "logs/",
        "solution": "Implementar RotatingFileHandler o limpiar en CI.",
        "impact": "Medio",
        "effort": "Bajo"
      },
      {
        "id": "IMP-INFRA-004",
        "priority": "MEDIUM",
        "title": "Instalar Playwright en CI para scraping",
        "description": "scraper_maestro.py requiere Playwright pero CI no lo instala.",
        "file": ".github/workflows/sonador.yml",
        "solution": "Agregar 'playwright install chromium' al workflow.",
        "impact": "Medio",
        "effort": "Bajo"
      },
      {
        "id": "IMP-INFRA-005",
        "priority": "LOW",
        "title": "Monitoreo de errores (Sentry)",
        "description": "Errores en produccion pasan desapercibidos.",
        "solution": "Integrar Sentry o similar para tracking de excepciones.",
        "impact": "Medio",
        "effort": "Medio"
      },
      {
        "id": "IMP-INFRA-006",
        "priority": "LOW",
        "title": "Migrar de CSV a SQLite",
        "description": "CSVs no escalan bien, queries limitados.",
        "solution": "Usar SQLite con ORM (SQLAlchemy) para mejor manejo.",
        "impact": "Alto",
        "effort": "Alto"
      }
    ],
    "testing": [
      {
        "id": "IMP-TEST-001",
        "priority": "HIGH",
        "title": "Tests para bot_dreamer.py",
        "description": "635 lineas sin cobertura de tests.",
        "file": "tests/test_bot_dreamer.py",
        "solution": "Crear tests unitarios para funciones principales.",
        "impact": "Alto",
        "effort": "Medio"
      },
      {
        "id": "IMP-TEST-002",
        "priority": "MEDIUM",
        "title": "Tests para scrapers con mocks",
        "description": "Scrapers no tienen tests, dependen de red.",
        "file": "tests/test_scrapers.py",
        "solution": "Mockear responses HTTP con responses o pytest-httpserver.",
        "impact": "Medio",
        "effort": "Medio"
      },
      {
        "id": "IMP-TEST-003",
        "priority": "MEDIUM",
        "title": "Tests de integracion pipeline completo",
        "description": "No hay test end-to-end del flujo Scraper->Prediccion->Auditoria.",
        "file": "tests/test_integration.py",
        "solution": "Crear test que ejecute pipeline completo con datos de prueba.",
        "impact": "Alto",
        "effort": "Alto"
      },
      {
        "id": "IMP-TEST-004",
        "priority": "MEDIUM",
        "title": "Tests para loto3_ultra.py",
        "description": "865 lineas nuevas sin tests.",
        "file": "tests/test_loto3_ultra.py",
        "solution": "Crear tests para cada componente del ensemble.",
        "impact": "Medio",
        "effort": "Medio"
      },
      {
        "id": "IMP-TEST-005",
        "priority": "LOW",
        "title": "Mutation testing",
        "description": "Verificar que tests realmente detectan bugs.",
        "solution": "Usar mutmut o cosmic-ray para mutation testing.",
        "impact": "Bajo",
        "effort": "Medio"
      }
    ],
    "architecture": [
      {
        "id": "IMP-ARCH-001",
        "priority": "HIGH",
        "title": "Crear clase base abstracta para predictores",
        "description": "Cada predictor tiene interfaz diferente, dificil de mantener.",
        "solution": "class BasePredictor(ABC): @abstractmethod def predict(), train(), etc.",
        "impact": "Alto",
        "effort": "Medio"
      },
      {
        "id": "IMP-ARCH-002",
        "priority": "MEDIUM",
        "title": "Unificar calculo de proximo sorteo",
        "description": "3 versiones diferentes en tricore, bot_dreamer, index.js.",
        "solution": "Centralizar en config.py y exponer como API.",
        "impact": "Medio",
        "effort": "Bajo"
      },
      {
        "id": "IMP-ARCH-003",
        "priority": "MEDIUM",
        "title": "Agregar type hints a todos los modulos",
        "description": "Casi ningun modulo usa type hints, dificulta debugging.",
        "solution": "Agregar type hints gradualmente, empezando por funciones publicas.",
        "impact": "Medio",
        "effort": "Medio"
      },
      {
        "id": "IMP-ARCH-004",
        "priority": "LOW",
        "title": "Documentar API interna con docstrings",
        "description": "Muchas funciones sin documentacion.",
        "solution": "Agregar docstrings en formato Google o NumPy.",
        "impact": "Bajo",
        "effort": "Medio"
      }
    ],
    "advanced": [
      {
        "id": "IMP-ADV-001",
        "priority": "LOW",
        "title": "LSTM para secuencias temporales",
        "description": "Capturar dependencias a largo plazo en secuencias de sorteos.",
        "solution": "Implementar LSTM con TensorFlow/PyTorch.",
        "impact": "Potencialmente alto",
        "effort": "Alto"
      },
      {
        "id": "IMP-ADV-002",
        "priority": "LOW",
        "title": "Transformer para patrones de combinaciones",
        "description": "Attention mechanism para detectar patrones complejos.",
        "solution": "Implementar mini-transformer o usar HuggingFace.",
        "impact": "Potencialmente alto",
        "effort": "Alto"
      },
      {
        "id": "IMP-ADV-003",
        "priority": "LOW",
        "title": "Reinforcement Learning para seleccion",
        "description": "Agente que aprende a seleccionar mejores predicciones.",
        "solution": "Q-Learning o Policy Gradient para optimizar seleccion.",
        "impact": "Experimental",
        "effort": "Alto"
      },
      {
        "id": "IMP-ADV-004",
        "priority": "LOW",
        "title": "Optimizacion bayesiana de hiperparametros",
        "description": "Mas eficiente que Grid Search para espacios grandes.",
        "solution": "Usar Optuna o scikit-optimize.",
        "impact": "Medio",
        "effort": "Medio"
      },
      {
        "id": "IMP-ADV-005",
        "priority": "LOW",
        "title": "Test chi-cuadrado para detectar sesgos",
        "description": "Verificar si distribucion de numeros es realmente uniforme.",
        "solution": "scipy.stats.chisquare() sobre frecuencias historicas.",
        "impact": "Bajo",
        "effort": "Bajo"
      },
      {
        "id": "IMP-ADV-006",
        "priority": "LOW",
        "title": "Deteccion de ciclos con FFT",
        "description": "Buscar periodicidades ocultas en los datos.",
        "solution": "numpy.fft.fft() sobre series de numeros por posicion.",
        "impact": "Experimental",
        "effort": "Medio"
      }
    ]
  },
  "summary": {
    "errors_by_severity": {
      "CRITICAL": 4,
      "HIGH": 3,
      "MEDIUM": 5,
      "LOW": 7
    },
    "improvements_by_priority": {
      "CRITICAL": 3,
      "HIGH": 10,
      "MEDIUM": 20,
      "LOW": 15
    },
    "improvements_by_category": {
      "ml_algorithms": 8,
      "features": 6,
      "auditing": 7,
      "data_quality": 4,
      "frontend": 6,
      "infrastructure": 6,
      "testing": 5,
      "architecture": 4,
      "advanced": 6
    },
    "top_10_priorities": [
      "ERR-003: ast.literal_eval() inseguro (SECURITY)",
      "ERR-001: FileLock con deadlock potencial (RACE_CONDITION)",
      "IMP-ML-001: Corregir overfitting en OraculoNeural (CRITICAL)",
      "IMP-AUD-001: Corregir scoring RACHA 0=100% (CRITICAL)",
      "IMP-INFRA-001: Sincronizar requirements.txt con CI (CRITICAL)",
      "ERR-002: OraculoNeural sin validacion (SILENT_FAILURE)",
      "ERR-010: Centralizar GAME_CONFIG (CONFIG_DUPLICATION)",
      "IMP-ML-002: Implementar XGBoost/LightGBM (HIGH)",
      "IMP-AUD-002: Reset periodico de EMA (HIGH)",
      "IMP-TEST-001: Tests para bot_dreamer.py (HIGH)"
    ]
  }
}
